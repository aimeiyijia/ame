---
title: el-table-ts
date: 2021-01-22 16:01:45
permalink: /pages/28073c/
categories:
  - 组件
tags:
  -
---

# el-table-ts

内含 el-table-ts、el-table-http 组件，el-table-http 组件核心为 axios 与 el-table-ts 组件

## 特性

1. 传递 data 和 column 两个必要属性即可渲染出表格，且兼容 element table 的全属性/事件。
2. 基于 el-table-ts、axios，封装出 el-table-http 组件，可以在仅指定`url`的情况下帮助你渲染出表格。
3. 兼容 element table 的属性及事件。
4. 支持 slot / jsx([参考 babel-plugin-transform-vue-jsx](https://github.com/vuejs/babel-plugin-transform-vue-jsx)) / h 函数三种方式自定义渲染表头，单元格数据。
5. 对外暴露出 table 内部的 store，this(\_self，表格组件自身)，如果你很熟悉 el-table，相信这可以帮到你。
6. 增加 el-table scroll 事件。
7. 集成 el-pagination 分页组件，且内置了插槽，扩展更加快捷。
8. 可在非 TS 环境下正常使用，但需自行构建 jsx 环境([参考 babel-plugin-transform-vue-jsx](https://github.com/vuejs/babel-plugin-transform-vue-jsx))。

## 安装和引入

安装

```js
npm install el-table-ts
```

引入

该组件强依赖于 element-ui 的 el-table 组件

```js
import ElementUI from 'element-ui'
import 'element-ui/lib/theme-chalk/index.css'

import ElTableTs from 'el-table-ts'

Vue.use(ElementUI)
Vue.use(ElTableTs)
```

### 基础用法

`data` 和 `columns` 两个属性

data 定义表格数据，columns 定义列属性

:::demo

```vue
<template>
  <el-table-ts :data="list" :columns="columns" />
</template>

<script>
  const listData = [
    {
      name: '刘小凡',
      sex: '男',
      age: 18,
      address: '江苏省 南京市',
      desc: {
        height: 180,
      },
    },
    {
      name: '张如霞',
      sex: '女',
      age: 16,
      address: '江苏省 南京市',
      desc: {
        height: 160,
      },
    },
  ]
  export default {
    data() {
      return {
        list: listData,
        columns: [
          { label: '姓名', prop: 'name' },
          { label: '性别', prop: 'sex' },
          { label: '年龄', prop: 'age' },
          { label: '地址', prop: 'address' },
          { label: '描述', prop: 'desc.height' },
        ],
      }
    },
  }
</script>
```

:::

### element-ui 属性及事件

兼容 el-table([参考 element table-attributes 部分](https://element.eleme.io/#/zh-CN/component/table#table-attributes))，el-table-column 所有属性和事件([参考 element table-column-attributes 部分](https://element.eleme.io/#/zh-CN/component/table#table-column-attributes))，表格属性绑定在组件属性中，列属性绑定在 columns 对象 属性值中

按下 F12(打开控制台)，点击年龄列查看`sort-change`事件

:::demo

```vue
<template>
  <el-table-ts
    :data="list"
    :columns="columns"
    @row-click="handleRowClick"
    @sort-change="handleSortChange"
    stripe
    border
  />
</template>

<script>
  const listData = [
    {
      name: '刘小凡',
      sex: '男',
      age: 18,
      address: '江苏省 南京市',
      desc: {
        height: 180,
      },
    },
    {
      name: '张如霞',
      sex: '女',
      age: 16,
      address: '江苏省 南京市',
      desc: {
        height: 160,
      },
    },
  ]
  export default {
    data() {
      return {
        list: listData,
        columns: [
          { label: '姓名', prop: 'name' },
          { label: '性别', prop: 'sex' },
          { label: '年龄', prop: 'age', sortable: true },
          { label: '地址', prop: 'address' },
          { label: '描述', prop: 'desc.height', align: 'right' },
        ],
      }
    },
    methods: {
      handleRowClick(row, column, event) {
        console.log(row, column, event)
      },
      handleSortChange(o) {
        console.log(o)
      },
    },
  }
</script>
```

:::

### 格式化列

element-ui 字段列中有 [formatter](https://element.eleme.cn/#/zh-CN/component/table)属性，el-table-ts 兼容该写法，并扩展了回调参数、使其与`customRender`，`customTitle`保持统一 - Function({cellValue, row, column, \$index, store, \_self})。

:::demo

```vue
<template>
  <el-table-ts :data="list" :columns="columns" />
</template>

<script>
  const listData = [
    {
      name: '刘小凡',
      sex: '男',
      age: 18,
      address: '江苏省 南京市',
      desc: {
        height: 180,
      },
    },
    {
      name: '张如霞',
      sex: '女',
      age: 16,
      address: '江苏省 南京市',
      desc: {
        height: 160,
      },
    },
  ]
  export default {
    data() {
      return {
        list: listData,
        columns: [
          { label: '姓名', prop: 'name' },
          { label: '性别', prop: 'sex' },
          {
            label: '年龄',
            prop: 'age',
            formatter: ({ cellValue }) => `${cellValue}岁`,
          },
          { label: '地址', prop: 'address' },
          { label: '描述', prop: 'desc.height' },
        ],
      }
    },
  }
</script>
```

:::

### 自定义表格-表头/单元格

支持 jsx/slot/h 函数三种方式的自定义渲染。

熟悉 slot 语法，可以在`scopedSlots.customRender`中设置 slot 名称，然后在 template 模板中写 slot

熟悉 jsx/h 语法，可直接在列定义中设置`customRender`函数中返回 JSX（注意此时需要 babel 支持，vue-cli3 自带），或者返回 h 函数创建生成的 VNode。

:::demo

```vue
<template>
  <el-table-ts :data="list" :columns="columns">
    <template #handle="{cellValue, row, column, $index, h}">
      <el-button size="small" type="primary" @click="handleView(row)">
        查看
      </el-button>
    </template>
  </el-table-ts>
</template>

<script>
  const listData = [
    {
      name: '刘小凡',
      sex: '男',
      age: 18,
      address: '江苏省 南京市',
      desc: {
        height: 180,
      },
    },
    {
      name: '张如霞',
      sex: '女',
      age: 16,
      address: '江苏省 南京市',
      desc: {
        height: 160,
      },
    },
  ]
  export default {
    data() {
      return {
        list: listData,
        columns: [
          { label: '姓名', prop: 'name' },
          { label: '性别', prop: 'sex' },
          {
            label: '年龄',
            prop: 'age',
            minWidth: '120px',
            // 可以这样
            // customRender/customTitle都支持JSX、h函数，请自行查阅这俩的使用方法
            customRender: ({ cellValue, row, column }) => {
              return (
                <div>
                  {row.name}：{cellValue}岁
                </div>
              )
            },
            customTitle: ({ $index }) => {
              return h('span', '这是一个美好的愿望')
            },
          },
          { label: '地址', prop: 'address' },
          { label: '描述', prop: 'desc.height' },
          {
            label: '操作',
            fixed: 'right',
            prop: 'handle',
            // 也可以这样
            scopedSlots: { customRender: 'handle' },
          },
        ],
      }
    },
    methods: {
      handleView({ name, age }) {
        this.$message.success(`${name} ${age}岁`)
      },
    },
  }
</script>
```

:::

### column Attributes 注意事项

Table-column Attributes 中 type[index/selection]时，使用的还是原生的渲染方式，不再支持 customRender/scopedSlots
type[expand]支持 customRender/scopedSlots，如下

:::demo

```vue
<template>
  <el-table-ts :data="list" :columns="columns">
    <template #handle="{cellValue, row, column, $index, h}">
      {{ `${row.name}：${row.age}岁` }}
    </template>
  </el-table-ts>
</template>

<script>
  const listData = [
    {
      name: '刘小凡',
      sex: '男',
      age: 18,
      address: '江苏省 南京市',
      desc: {
        height: 180,
      },
    },
    {
      name: '张如霞',
      sex: '女',
      age: 16,
      address: '江苏省 南京市',
      desc: {
        height: 160,
      },
    },
  ]
  export default {
    data() {
      return {
        list: listData,
        columns: [
          {
            label: '',
            type: 'expand',
            // 可以这样
            scopedSlots: { customRender: 'handle' },

            // 也可以这样
            // customRender: (val, row, column, index, h) =>
            //   h('div', `${row.name}、${row.storage}`),
          },
          { label: '姓名', prop: 'name' },
          { label: '性别', prop: 'sex' },
          { label: '年龄', prop: 'age' },
          { label: '地址', prop: 'address' },
          { label: '描述', prop: 'desc.height' },
        ],
      }
    },
  }
</script>
```

:::

### scroll 事件

按下 F12(打开控制台)，滚动表格查看`scroll`事件

:::demo

```vue
<template>
  <el-table-ts
    :data="list"
    :columns="columns"
    height="350"
    @scroll="handleScroll"
  />
</template>

<script>
  const listData = [
    {
      name: '刘小凡',
      sex: '男',
      age: 18,
      address: '江苏省 南京市',
      desc: {
        height: 180,
      },
    },
    {
      name: '张如霞',
      sex: '女',
      age: 16,
      address: '江苏省 南京市',
      desc: {
        height: 160,
      },
    },
    {
      name: '张如霞',
      sex: '女',
      age: 16,
      address: '江苏省 南京市',
      desc: {
        height: 160,
      },
    },
    {
      name: '张如霞',
      sex: '女',
      age: 16,
      address: '江苏省 南京市',
      desc: {
        height: 160,
      },
    },
  ]
  export default {
    data() {
      return {
        list: listData,
        columns: [
          { label: '姓名', prop: 'name' },
          { label: '性别', prop: 'sex' },
          { label: '年龄', prop: 'age' },
          { label: '地址', prop: 'address' },
          { label: '描述', prop: 'desc.height' },
        ],
      }
    },
    methods: {
      handleScroll(e) {
        console.log(e)
      },
    },
  }
</script>
```

:::

### 集成 pagination

默认展示

分页器，参考 [el-pagination 文档](https://element.eleme.cn/#/zh-CN/component/pagination#attributes)，

默认分页配置为

```js
const defPagination = {
  currentPage: 1,
  pageSizes: [10, 20, 30, 50],
  pageSize: 10,
  layout: 'prev, pager, next, sizes, total',
  background: true,
}
```

增加内置插槽,名为`pagination`，可访问到总数`total`,分页配置项`config`

[分页事件详见](#el-table-ts-事件)

> 在原组件中 prev-click，next-click 事件均会触发 current-change 事件，这可能会让你无法得知 page-change 是来自页码切换还是上一页或下一页，ElTableTs 组件中也未进行区分，

:::demo

```vue
<template>
  <el-table-ts
    :data="list"
    :columns="columns"
    :pagination="{ layout: 'prev, pager, next', background: true }"
    :total="100"
    @page-change="handlePageChange"
  >
    <template #pagination="{total, config}">
      <span>{{ total }}/第五页</span>
    </template>
  </el-table-ts>
</template>

<script>
  const listData = [
    {
      name: '刘小凡',
      sex: '男',
      age: 18,
      address: '江苏省 南京市',
      desc: {
        height: 180,
      },
    },
    {
      name: '刘小凡',
      sex: '男',
      age: 18,
      address: '江苏省 南京市',
      desc: {
        height: 180,
      },
    },
  ]
  export default {
    data() {
      return {
        list: listData,
        columns: [
          { label: '姓名', prop: 'name' },
          { label: '性别', prop: 'sex' },
          { label: '年龄', prop: 'age' },
          { label: '地址', prop: 'address' },
          { label: '描述', prop: 'desc.height' },
        ],
      }
    },
    methods: {
      handlePageChange({ pageSize, currentPage }) {
        console.log(pageSize, currentPage)
      },
    },
  }
</script>
<style>
  .el-pagination {
    margin-top: 10px;
    margin-left: -10px;
  }
</style>
```

:::

## el-table-http

基于 el-table-ts 组件, axios。
使用同 el-table-ts，不同点在于增加了 network 配置项，当存在此配置项时，data 属性将失效

:::demo

```vue
<template>
  <el-table-http :netWork="httpConfig" :columns="columns" />
</template>

<script>
  const listData = [
    {
      name: '刘小凡',
      sex: '男',
      age: 18,
      address: '江苏省 南京市',
      desc: {
        height: 180,
      },
    },
    {
      name: '张如霞',
      sex: '女',
      age: 16,
      address: '江苏省 南京市',
      desc: {
        height: 160,
      },
    },
  ]
  export default {
    data() {
      return {
        columns: [
          { label: '姓名', prop: 'name' },
          { label: '性别', prop: 'sex' },
          { label: '年龄', prop: 'age' },
          { label: '地址', prop: 'address' },
          { label: '描述', prop: 'desc.height' },
        ],
        // 目前判断是否成功发起请求的唯一标识为  内部是否获取到关键数据
        httpConfig: {
          method: 'get',
          // 创建axios实例时传递的参数
          createConfig: {},

          // 发起请求时的额外参数，
          // 当已配置 method, url, data时，在httpConfig中这三个配置会失效
          httpConfig: {},

          // 发起请求时的额外数据
          data: {
            pageSizeTest: 10,
            pageNoTest: 1,
          },
          // 请求的url
          url: 'http://test.data',

          // 分页传参名称配置
          pag: {
            pageSizeName: 'pageSizeTest',
            pageNoName: 'pageNoTest',
          },

          // 解析路径
          // 标准格式为 {code, data: {[dataname]: 表格数据, total: 总条数}, msg }
          path: {
            // data的解析路径(对象取值语法data.data或data[data]),到data的目录为止，不需要包含[dataname]，例如在标准格式下 dataPath为 'data'
            // 不指定就按照标准格式路径去解析
            dataPath: 'data',
            // 不指定就默认dataName为data
            dataName: 'records',
          },
        },
      }
    },
  }
</script>
```

:::

## API

### el-table-ts 属性

支持 el-table 上所有[原有属性](https://element.eleme.cn/#/zh-CN/component/table#table-attributes)，同时扩展以下 api。

| 参数       | 类型    | 默认值 | 说明                                                                                                                                   |
| ---------- | ------- | ------ | -------------------------------------------------------------------------------------------------------------------------------------- |
| loading    | Boolean | false  | 动效 loading                                                                                                                           |
| data       | Array   | []     | 列表数据                                                                                                                               |
| columns    | Array   | []     | column item 配置列表，详细见[如下 columns Attrs](#columns-属性)                                                                        |
| pagination | Object  | {}     | 翻页器配置，默认未设置，不显示翻页器。相关 api 可查看[el-pagination](https://element.eleme.cn/#/zh-CN/component/pagination#attributes) |
| total      | Number  | 0      | 翻页器条数总数                                                                                                                         |

### el-table-ts 事件

支持 el-table 上所有[原有事件](https://element.eleme.cn/#/zh-CN/component/table#table-events)，同时扩展以下 api。

| 事件名称    | 说明             | 说明                      |
| ----------- | ---------------- | ------------------------- |
| scroll      | table 滚动条事件 | e                         |
| page-change | 页码改变事件     | { pageSize, currentPage } |
| size-change | 页数改变事件     | { pageSize, currentPage } |

### columns 属性

支持 el-table-column 所有[原有属性](https://element.eleme.cn/#/zh-CN/component/table#table-column-attributes)、[Scoped Slot](https://element.eleme.cn/#/zh-CN/component/table#table-column-scoped-slot),同时扩展以下 api：

| Attr         | Type     | Default | Description                                                                                                                     |
| ------------ | -------- | ------- | ------------------------------------------------------------------------------------------------------------------------------- |
| label        | String   |         | 列名称                                                                                                                          |
| prop         | String   |         | 列数据字段，支持多层对象嵌套，如 user.email.prefix                                                                              |
| hidden       | Boolean  |         | 是否隐藏该列。建议是一个 computed，使得可以响应式显示隐藏                                                                       |
| customRender | Function |         | 自定义列数据渲染。函数参数(value, row, column, \$index, h)，**支持 jsx 和 h 函数**                                              |
| customTitle  | Function |         | 自定义列头部渲染。函数参数(column, \$index, h)，**支持 jsx 和 h 函数**                                                          |
| scopedSlots  | Object   |         | **使用 slot 方式自定义渲染**，替换 customRender/customTitle 函数。比如：{ customRender: 'slotName1', customTitle: 'slotName2' } |

### 内置分页插槽
